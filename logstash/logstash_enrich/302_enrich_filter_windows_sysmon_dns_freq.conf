filter {
    if [winlog][event_id] == 22 {
        mutate {
            add_tag => [ "ServiceFlagDNS22" ]
            add_field => { "[QueryName]" => "%{[winlog][event_data][QueryName]}" }
        }
        rest {
          request => {
            url => "http://freqserver:10004/measure1/%{QueryName}"
          }
          sprintf => true
          json => false
          target => "frequency_score"
        }
        rest {
          request => {
            url => "http://domainstats:20000/alexa/%{QueryName}"
          }
          sprintf => true
          json => false
          target => "domain_score"
        }
        mutate {
          convert => [ "domain_score", "float" ]
        }
        rest {
          request => {
            url => "http://domainstats:20000/creation_date/%{QueryName}"
          }
          sprintf => true
          json => false
          target => "domain_creationdate"
        }
    }
}