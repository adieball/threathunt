filter {
    if [winlog][event_id] == 7045 or [winlog][event_id] == 4697 {
        mutate {
            add_tag => [ "ServiceFlag7045" ]
            add_field => { "[ServiceName]" => "%{[winlog][event_data][ServiceName]}" }
        }
        rest {
          request => {
            url => "http://freqserver:10004/measure1/%{ServiceName}"
          }
          sprintf => true
          json => false
          target => "SVC_frequency_score"
        }
        mutate {
          convert => [ "frequency_score", "float" ]
        }
    }
}